<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layouts/main}">
	<head>
		<title>Dashboard</title>
		<th:block layout:fragment="extra-css">
			<style>
				.stat-card {
					background: #fff;
					border: 1px solid #dee2e6;
					border-radius: 4px;
					padding: 20px;
					margin-bottom: 20px;
					transition: box-shadow 0.3s ease;
				}

				.stat-card:hover {
					box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
				}

				.stat-icon {
					font-size: 28px;
					color: #999;
					margin-bottom: 10px;
				}

				.stat-number {
					font-size: 28px;
					font-weight: bold;
					color: #333;
					margin: 10px 0;
				}

				.stat-label {
					font-size: 14px;
					color: #666;
					margin-bottom: 10px;
				}

				.stat-link {
					font-size: 12px;
					color: #0066cc;
					text-decoration: none;
					transition: text-decoration 0.2s ease;
				}

				.stat-link:hover {
					text-decoration: underline;
				}

				.stat-link i {
					font-size: 10px;
					margin-left: 4px;
				}

				.card {
					border: 1px solid #dee2e6;
					border-radius: 4px;
					background-color: #fff;
				}

				.card-header {
					background-color: #f8f9fa;
					border-bottom: 1px solid #dee2e6;
					padding: 15px;
				}

				.card-title {
					color: #333;
					font-size: 16px;
					font-weight: 500;
					margin: 0;
				}

				.card-body {
					padding: 20px;
				}

				.chart-container {
					position: relative;
					height: 300px;
				}
			</style>
		</th:block>
	</head>
	<body>
		<section layout:fragment="content">
			<div class="row">
				<div class="col-md-3 col-sm-6">
					<div class="stat-card">
						<div class="stat-icon">
							<i class="fas fa-door-open"></i>
						</div>
						<div class="stat-label">Total Rooms</div>
						<div class="stat-number" th:text="${dashboardData.rooms.totalElements}">0</div>
						<a th:href="@{/administration/components/rooms}" class="stat-link"> View Details <i class="fas fa-arrow-right"></i> </a>
					</div>
				</div>

				<div class="col-md-3 col-sm-6">
					<div class="stat-card">
						<div class="stat-icon">
							<i class="fas fa-cube"></i>
						</div>
						<div class="stat-label">Total Hubs</div>
						<div class="stat-number" th:text="${dashboardData.hubs.totalElements}">0</div>
						<a th:href="@{/administration/components/hubs}" class="stat-link"> View Details <i class="fas fa-arrow-right"></i> </a>
					</div>
				</div>

				<div class="col-md-3 col-sm-6">
					<div class="stat-card">
						<div class="stat-icon">
							<i class="fas fa-microchip"></i>
						</div>
						<div class="stat-label">Total Devices</div>
						<div class="stat-number" th:text="${dashboardData.devices.totalElements}">0</div>
						<a th:href="@{/administration/components/devices}" class="stat-link"> View Details <i class="fas fa-arrow-right"></i> </a>
					</div>
				</div>

				<div class="col-md-3 col-sm-6">
					<div class="stat-card">
						<div class="stat-icon">
							<i class="fas fa-thermometer-half"></i>
						</div>
						<div class="stat-label">Total Sensors</div>
						<div class="stat-number" th:text="${dashboardData.sensors.totalElements}">0</div>
						<a th:href="@{/administration/components/sensors}" class="stat-link"> View Details <i class="fas fa-arrow-right"></i> </a>
					</div>
				</div>
			</div>

			<div class="row mt-4">
				<div class="col-md-12">
					<div class="card">
						<div class="card-header">
							<h3 class="card-title">Statistics Overview</h3>
						</div>
						<div class="card-body">
							<div class="chart-container">
								<canvas id="quantityChart"></canvas>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<th:block layout:fragment="extra-js">
			<script th:inline="javascript">
				/*<![CDATA[*/
				$(function () {
					const roomCount = /*[[${dashboardData.rooms.totalElements}]]*/ 0;
					const hubCount = /*[[${dashboardData.hubs.totalElements}]]*/ 0;
					const deviceCount = /*[[${dashboardData.devices.totalElements}]]*/ 0;
					const sensorCount = /*[[${dashboardData.sensors.totalElements}]]*/ 0;

					const chartData = {
						labels: ['Rooms', 'Hubs', 'Devices', 'Sensors'],
						datasets: [
							{
								label: 'Count',
								backgroundColor: ['rgba(200, 200, 200, 0.5)', 'rgba(150, 150, 150, 0.5)', 'rgba(100, 100, 100, 0.5)', 'rgba(50, 50, 50, 0.5)'],
								borderColor: ['rgba(200, 200, 200, 1)', 'rgba(150, 150, 150, 1)', 'rgba(100, 100, 100, 1)', 'rgba(50, 50, 50, 1)'],
								borderWidth: 1,
								data: [roomCount, hubCount, deviceCount, sensorCount],
							},
						],
					};

					const chartOptions = {
						responsive: true,
						maintainAspectRatio: false,
						scales: {
							y: {
								ticks: {
									beginAtZero: true,
									callback: function (value) {
										return Number.isInteger(value) ? value : '';
									},
								},
								grid: {
									color: 'rgba(200, 200, 200, 0.2)',
								},
							},
							x: {
								grid: {
									display: false,
								},
							},
						},
						plugins: {
							legend: {
								display: false,
							},
							tooltip: {
								backgroundColor: 'rgba(0, 0, 0, 0.8)',
								padding: 10,
								cornerRadius: 4,
							},
						},
					};

					new Chart($('#quantityChart').get(0).getContext('2d'), {
						type: 'bar',
						data: chartData,
						options: chartOptions,
					});
				});
				/*]]>*/
			</script>
		</th:block>
	</body>
</html>
